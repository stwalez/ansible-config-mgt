 pipeline {
  agent any
  
  stages {
    stage('Build') {
      steps {
        script {
          sh 'echo "Building Stage"'
        }
      }
    }

    stage('Test') {
      steps {
        script {
          sh 'echo "Testing Stage"'
        }
      }
    }

    stage('Package') {
      steps {
        script {
          sh 'echo "Package Stage"'
        }
      }
    }

    stage('Deploy') {
      options {
        timeout(time: 5, unit: 'MINUTES')   // timeout on this stage
      }
      steps {
        script {
          sh 'echo "Deploy Stage"'
          ansiblePlaybook credentialsId: 'private_key', disableHostKeyChecking: true, installation: 'ansible', inventory: 'inventory/dev.yml', playbook: 'playbooks/site.yml'
        }
      }
    }

    stage('Clean Up') {
      steps {
        script {
          sh 'echo "Clean Up Stage"'
        }
      }
    }
  }
}
